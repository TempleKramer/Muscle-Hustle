{"ast":null,"code":"import jwt from\"jsonwebtoken\";var secret=\"mysecretsshhhhh\";var expiration=\"2h\";export default{authMiddleware:function authMiddleware(_ref){var req=_ref.req;// allows token to be sent via req.body, req.query, or headers\nvar token=req.body.token||req.query.token||req.headers.authorization;// [\"Bearer\", \"<tokenvalue>\"]\nif(req.headers.authorization){token=token.split(\" \").pop().trim();}if(!token){return req;}try{var _jwt$verify=jwt.verify(token,secret,{maxAge:expiration}),data=_jwt$verify.data;req.user=data;}catch(_unused){console.log(\"Invalid token\");}return req;},signToken:function signToken(_ref2){var username=_ref2.username,email=_ref2.email,_id=_ref2._id;var payload={username:username,email:email,_id:_id};return jwt.sign({data:payload},secret,{expiresIn:expiration});},login:function login(token){window.localStorage.setItem('token',token);},loggedIn:function loggedIn(){return!!window.localStorage.getItem('token');},logout:function logout(){window.localStorage.setItem('token',\"\");window.location='/';}};","map":{"version":3,"names":["jwt","secret","expiration","authMiddleware","req","token","body","query","headers","authorization","split","pop","trim","verify","maxAge","data","user","console","log","signToken","username","email","_id","payload","sign","expiresIn","login","window","localStorage","setItem","loggedIn","getItem","logout","location"],"sources":["C:/Users/jarma/school/challenges/Project3_Final/client/src/utils/auth.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nconst secret = \"mysecretsshhhhh\";\nconst expiration = \"2h\";\n\nexport default {\n  authMiddleware: function ({ req }) {\n    // allows token to be sent via req.body, req.query, or headers\n    let token = req.body.token || req.query.token || req.headers.authorization;\n\n    // [\"Bearer\", \"<tokenvalue>\"]\n    if (req.headers.authorization) {\n      token = token.split(\" \").pop().trim();\n    }\n\n    if (!token) {\n      return req;\n    }\n\n    try {\n      const { data } = jwt.verify(token, secret, { maxAge: expiration });\n      req.user = data;\n    } catch {\n      console.log(\"Invalid token\");\n    }\n\n    return req;\n  },\n  signToken: function ({ username, email, _id }) {\n    const payload = { username, email, _id };\n\n    return jwt.sign({ data: payload }, secret, { expiresIn: expiration });\n  },\n  login: function(token) {\n    window.localStorage.setItem('token', token)\n  },\n  loggedIn: function () {\n    return !!window.localStorage.getItem('token');\n\n  },\n  logout: function() {\n    window.localStorage.setItem('token', \"\")\n    window.location = '/'\n  }\n};\n\n"],"mappings":"AAAA,MAAOA,IAAP,KAAgB,cAAhB,CAEA,GAAMC,OAAM,CAAG,iBAAf,CACA,GAAMC,WAAU,CAAG,IAAnB,CAEA,cAAe,CACbC,cAAc,CAAE,6BAAmB,IAAPC,IAAO,MAAPA,GAAO,CACjC;AACA,GAAIC,MAAK,CAAGD,GAAG,CAACE,IAAJ,CAASD,KAAT,EAAkBD,GAAG,CAACG,KAAJ,CAAUF,KAA5B,EAAqCD,GAAG,CAACI,OAAJ,CAAYC,aAA7D,CAEA;AACA,GAAIL,GAAG,CAACI,OAAJ,CAAYC,aAAhB,CAA+B,CAC7BJ,KAAK,CAAGA,KAAK,CAACK,KAAN,CAAY,GAAZ,EAAiBC,GAAjB,GAAuBC,IAAvB,EAAR,CACD,CAED,GAAI,CAACP,KAAL,CAAY,CACV,MAAOD,IAAP,CACD,CAED,GAAI,CACF,gBAAiBJ,GAAG,CAACa,MAAJ,CAAWR,KAAX,CAAkBJ,MAAlB,CAA0B,CAAEa,MAAM,CAAEZ,UAAV,CAA1B,CAAjB,CAAQa,IAAR,aAAQA,IAAR,CACAX,GAAG,CAACY,IAAJ,CAAWD,IAAX,CACD,CAAC,cAAM,CACNE,OAAO,CAACC,GAAR,CAAY,eAAZ,EACD,CAED,MAAOd,IAAP,CACD,CAtBY,CAuBbe,SAAS,CAAE,yBAAoC,IAAxBC,SAAwB,OAAxBA,QAAwB,CAAdC,KAAc,OAAdA,KAAc,CAAPC,GAAO,OAAPA,GAAO,CAC7C,GAAMC,QAAO,CAAG,CAAEH,QAAQ,CAARA,QAAF,CAAYC,KAAK,CAALA,KAAZ,CAAmBC,GAAG,CAAHA,GAAnB,CAAhB,CAEA,MAAOtB,IAAG,CAACwB,IAAJ,CAAS,CAAET,IAAI,CAAEQ,OAAR,CAAT,CAA4BtB,MAA5B,CAAoC,CAAEwB,SAAS,CAAEvB,UAAb,CAApC,CAAP,CACD,CA3BY,CA4BbwB,KAAK,CAAE,eAASrB,KAAT,CAAgB,CACrBsB,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAqCxB,KAArC,EACD,CA9BY,CA+BbyB,QAAQ,CAAE,mBAAY,CACpB,MAAO,CAAC,CAACH,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B,OAA5B,CAAT,CAED,CAlCY,CAmCbC,MAAM,CAAE,iBAAW,CACjBL,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAqC,EAArC,EACAF,MAAM,CAACM,QAAP,CAAkB,GAAlB,CACD,CAtCY,CAAf"},"metadata":{},"sourceType":"module"}